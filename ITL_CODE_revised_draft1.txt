ITL: 


if ( DATA_SOURCE.equalsIgnoreCase("AOTS") || DATA_SOURCE.equalsIgnoreCase("BMP") ) 
{
 if ( CHILD_DATA_SOURCE.equalsIgnoreCase("BMP") || CHILD_DATA_SOURCE.equalsIgnoreCase("WFAC") || CHILD_DATA_SOURCE.equalsIgnoreCase("WMS") )
 {
   /* Place all data consumed from ITL Topic to MongoDB collection */
	
   /* check if CHILD_TICKET_NUMBER from ITL receiver exists in ITL REDIS hashmap */
   if ( CHILD_TICKET_NUMBER NOT IN ITL REDIS hashmap ) /* Question: Is this an expensive Call */
   {
	create a new Map where KEY IS "CHILD_TICKET_NUMBER": 
	{"TICKET_NUMBER":"","DATA_SOURCE":"","CHILD_DATA_SOURCE":"","REPT_SVC_LINE_DESC_TX":"","REPORTED_BY":"",
	"CHILD_COMPOSITE_TICKET_NUMBER":"","ASSET_ID":"","CIRCUIT_ID":""}
   }
   else IF ( CHILD_TICKET_NUMBER EXISTS in ITL REDIS hashmap ) /* Question: Is this an expensive Call */
   {
     IF (  CHILD_COMPOSITE_TICKET_NUMBER is NOT NULL ) /* Question: Is this an expensive Call */
	 {
		IF ( ITL REDIS KEY contains value for EDGE_DATA_ZONE && ITL REDIS KEY contains value for TICKET_NUMBER )
		{ /* Question: Is this an expensive Call */
		  /* check the format of CHILD_COMPOSITE_TICKET_NUMBER if WFAC, BMP, WMS */
			if ( CHILD_COMPOSITE_TICKET_NUMBER.startsWith("WFAC") )
			{
			  composite_zone_substr = CHILD_COMPOSITE_TICKET_NUMBER.split(13,17)
			}
			else if ( CHILD_COMPOSITE_TICKET_NUMBER.startsWith("BMP") )
			{
			  composite_zone_substr = CHILD_COMPOSITE_TICKET_NUMBER.split(9,12)
			}
			else if ( CHILD_COMPOSITE_TICKET_NUMBER.startsWith("WMS") )
			{
			  composite_zone_substr = CHILD_COMPOSITE_TICKET_NUMBER.split(9,12)
			}
	
			itl_zone_edge_map = match_Zone(composite_zone_substr) /* OR Use a REDIS Map to get the corresponding EDGE ZONE */
			
		  /* check if ZONE in CHILD_COMPOSITE_TICKET_NUMBER matches with EDGE_DATA_ZONE */
		  IF ( CHILD_COMPOSITE_TICKET_NUMBER ZONE != EDGE_DATA_ZONE )
		  {
			// Update the TICKET NUMBER from ITL Topic TICKET_NUMBER field.
		  }
		}
		ELSE IF ( ITL REDIS KEY contains value for EDGE_DATA_ZONE && NOT(ITL REDIS KEY contains value for TICKET_NUMBER )
		{
			/* Append the following values to ITL REDIS KEY 
			{"TICKET_NUMBER":"","DATA_SOURCE":"","CHILD_DATA_SOURCE":"","REPT_SVC_LINE_DESC_TX":"","REPORTED_BY":"",
			"CHILD_COMPOSITE_TICKET_NUMBER":"","ASSET_ID":"","CIRCUIT_ID":""} */
     }
   }
   ELSE IF ( CHILD_COMPOSITE_TICKET_NUMBER is NULL && ITL REDIS KEY contains value for EDGE_DATA_ZONE && NOT(ITL REDIS KEY contains value for TICKET_NUMBER ) )
   {
			/* Append the following values to ITL REDIS KEY 
			{"TICKET_NUMBER":"","DATA_SOURCE":"","CHILD_DATA_SOURCE":"","REPT_SVC_LINE_DESC_TX":"","REPORTED_BY":"",
			"CHILD_COMPOSITE_TICKET_NUMBER":"","ASSET_ID":"","CIRCUIT_ID":""} */
   }
}   
/* function to match ITL Zones with EDGE Zones */
def match_Zone(zn: String): String = {
  zn match {
    case "AIM26" | "AIM50" | "AIM53" | "AIM56" | "AIM58"  => "MW"
    case "IMST5" | "IMSC5" => "SW"
    case "GAC" | "CAC" | "LMC" | "148" | "NFC" | "SFC" | "TNC" => "SE"
	case "APNSDNH" | "APNSDSS" => "W" 
	case _ => "NA"
  }
			

###############################################################################################################################
###############################################################################################################################
1) There are 3 xls each for source AOTS, BMP and WFAC respectively. The CHILD_COMPOSITE_TICKET_NUMBER  is <BLANKS> for most of the entries. 
     Q) Should we ignore such entries?
                Yes we can ignore. CHILD_COMPOSITE_TICKET_NUMBER comes in picture, when duplicate child tickets are there. So im assume, if they are blank, the corresponding child ticket number would be unique. But we can discuss if any exceptional case occurs. 
     Q) Each  AOTS, BMP and WFAC can have CHILD_COMPOSITE_TICKET_NUMBER  starting with either AOTS OR BMP OR WFAC. Is this true?
 Yes CHILD_COMPOSITE_TICKET_NUMBER will have a format starting with Child Data Source value. 
2) In SampleWFAC.xls, all CHILD_COMPOSITE_TICKET_NUMBER  is <BLANKS>. 
     Q) Will this be true for all the records coming from WFAC?
CHILD_COMPOSITE_TICKET_NUMBER comes in picture, when duplicate child tickets are there. So im assume, if they are blank, the corresponding child ticket number would be unique. But we can discuss if any exceptional case occurs.
3) As gathered from all the 3 sample XLS, only the following values of CHILD_COMPOSITE_TICKET_NUMBER  are visible:
        AOTS : WFACLA097913IMSC5, BMP891801242
        BMP  : WMS891810505,WMS891810505
        WFAC : < no values > 
     Q) Is this assumption true that 
CHILD_COMPOSITE_TICKET_NUMBER  	Length of the Value
WFACLA097913IMSC5	17 characters
BMP891801242	12 characters
WMS891810505	12 characters
                Mostly our  child ticket will fall into the WFAc   child data sourced tickets. So if BMP WMS ones don’t have region then we are still good, as we wont hit these records in our condition check. 
   Q) for the BMP and WMS values, the last 3-4 characters do not match any of the 17 ITL values mentioned for mapping. Shall we ignore such CHILD_COMPOSITE_TICKET_NUMBER  values?
 BMP WMS ones don’t have region then we are still good, as we won’t hit these records in our condition check. So we can ignore. Let me know if certain children do hit this case. 
4) In SampleBMP.xls, the scenario is following i.e. , CHILD_TICKET_NUMBER & CHILD_COMPOSITE_TICKET_NUMBER are same for different Parent TICKET_NUMBER.
    This negates the assumption that CHILD_COMPOSITE_TICKET_NUMBER will be of different ZONES for same CHILD_TICKET_NUMBER.
        Q) could you please check my understanding?
TICKET_NUMBER	CHILD_TICKET_NUMBER	CHILD_COMPOSITE_TICKET_NUMBER
1110866968	891810505	WMS891810505
1110869600	891810505	WMS891810505
 In general for Point 3 and 4, if we filter in EDGE SOURCETYPE=WFAC and ATTMAOTS, we wont even hit the records in ITL starting with WMS and BMP. Let me know if theer is an exceptions case. 
