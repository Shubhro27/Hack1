https://www.dezyre.com/article/pig-interview-questions-and-answers-for-2017/244
https://intellipaat.com/interview-question/pig-interview-questions/
https://acadgild.com/blog/top-12-pig-interview-questions-in-2017/
-------------------------------------------
Writing Macro in Pig: http://www.hadooplessons.info/2014/12/writing-macro-in-pig.html

-------------------------------------------
DAG: Directed acyclic graph in PIG is thrown on top of mapreduce (but DAG is not always mutually exclusive with map-reduce).
Tez uses the concept of a DAG to enforce concurrency and serialization between MapReduce jobs. 
Say, for example, jobs A and B are independent of each other, but job C needs the results from A and B to complete, 
Tez will execute A and B in any order and forward the results to C, which is most easily accomplished by specifying job ordering with a DAG.
 
Why is output in Pig is not sorted by default?
Outputs in PIG can be obtained by two methods.
1. DUMP – on the Screen 
2. STORE – in the file-system

Whenever either of these commands is given a DAG is created and fastest method for operation is used to generate the result which is then either displayed on screen or 
stored in file as per the command. Till then no operation is done as PIG follows Lazy Evaluation.

Now PIG allocates a fixed amount of memory to store bags of data. 
And that memory space is even shared with all the other bags of data that are used by the application. 
Also if the outputs are stored that with increase the processing time and overhead related to reading the data from memory and loading. 
So to speed up the process by default the outputs in PIG are not stored.

To speed up processing and leverage the underlying Map Reduce framework to its full potential, PIG took this route. 
We can impose sorting on the output by using the 'ORDER BY' command
--------------------------------------------
what does this warning mean "Encountered Warning IMPLICIT_CAST_TO_DOUBLE 16 time(s)."

You'll get the warnings when Pig has to implicitly cast from one type to another, for instance when you pass a field as an argument to a function 
that requires some type but the field is another type.
casts always cost, so you should try to eliminate data type casting as much as you can.
--------------------------------------------
What is Piggy Bank:
is a place for Pig users to share their functions

example:
REGISTER /public/share/pig/contrib/piggybank/java/piggybank.jar ;
TweetsInaug  = FILTER Tweets BY org.apache.pig.piggybank.evaluation.string.UPPER(text) MATCHES '.*(INAUG|OBAMA|BIDEN|CHENEY|BUSH).*' ;
STORE TweetsInaug INTO 'meta/inaug/tweets_inaug' ;

More details to use Piggy Bank: https://stackoverflow.com/questions/27414351/how-to-use-over-function-in-piggybank
-------------------------------------------
Pig  if-then-else construction:

Pig is data flow language not control flow. So having intense control flows is not preferred in PIG LATIN.

Pig's if-then-else is an arithmetic operator invoked with the shorthand "condition ? true_value : false_value" as part of an expression, such as:
X = FOREACH A GENERATE f2, (f2==1?1:COUNT(B));

case statement can be done as,
c2 = FOREACH c1 GENERATE (CASE group
                            WHEN 1 THEN 'NE'
                            WHEN 2 THEN 'SE'
                            WHEN 3 THEN 'AE'
                            ELSE 'VR' END), COUNT(country.zone);

--------------------------------------------
Explain about the BloomMapFile. (more info required)

It is an extended class of MapFile. Its functionality is similar to MapFile. 
It is used in the Hbase table format, Bloom Map File uses dynamic Bloom filters to provide rapid membership test for the keys.
--------------------------------------------
UNION() and SPLIT() functions

Union operator helps to merge the contents of two or more relations.
Syntax: grunt> Relation_name3 = UNION Relation_name1, Relation_name2
Example: grunt> INTELLIPAAT = UNION intellipaat_data1.txt intellipaat_data2.txt

SPLIT operator helps to divide the contents of two or more relations.
Syntax: grunt> SPLIT Relationa1_name INTO Relationa2_name IF (condition1), Relation2_name (condition2);
Example: SPLIT student_details into student_details1 if marks<35, student_details2 if (8590);



--------------------------------------------
TOP() 
TOP () function returns the top N tuples from a bag of tuples or a relation. 
N is passed as a parameter to the function top () along with the column whose values are to be compared and the relation R.

What is the opposite of TOP()?
--------------------------------------------
DESCRIBE, EXPLAIN, ILLUSTRATE operators in PIG: https://pig.apache.org/docs/r0.11.1/test.html
i.e.  the exception handling operators in Pig script
--------------------------------------------
12) Explain about the execution plans of a Pig Script 
	Or 
	Differentiate between the logical and physical plan of an Apache Pig script

	Logical and Physical plans are created during the execution of a pig script. Pig scripts are based on interpreter checking. 
	Logical plan is produced after semantic checking and basic parsing and no data processing takes place during the creation of a logical plan. 
	For each line in the Pig script, syntax check is performed for operators and a logical plan is created. 
	Whenever an error is encountered within the script, an exception is thrown and the program execution ends, else for each statement in the script has its own logical plan.

	A logical plan contains collection of operators in the script but does not contain the edges between the operators.

	After the logical plan is generated, the script execution moves to the physical plan where there is a description about the physical operators, Apache Pig will use,
	 to execute the Pig script. A physical plan is more or less like a series of MapReduce jobs but then the plan does not have any reference on 
	 how it will be executed in MapReduce. 
	 During the creation of physical plan, cogroup logical operator is converted into 3 physical operators namely –Local Rearrange, Global Rearrange and Package. 
	 Load and store functions usually get resolved in the physical plan.
	 
----------------------------------------------
GROUP and COGROUP
----------------------------------------------
What are the relation operations in Pig?
foreach, order by, filters, group, distinct, join, limit.foreach: It takes a set of expressions and applies them to all records in the data pipeline to the next operator
example, 
A =LOAD ‘input’ as (emp_name :charrarray, emp_id : long, emp_add : chararray, phone : chararray, preferences : map [] )
alias = FILTER alias BY expression;
It contains a predicate and it allows us to select which records will be retained in our data pipeline.
