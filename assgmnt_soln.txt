spark-shell --packages com.databricks:spark-csv_2.10:1.5.0

val firedept_df = sqlContext.read.format("com.databricks.spark.csv").option("header", "true").option("inferSchema", "true").option("delimiter", ",").load("sb_sparkSQL_ds/fire_snapshot.csv")

|Call Number|Unit ID|Incident Number|           Call Type| Call Date|Watch Date|       Received DtTm|          Entry DtTm|       Dispatch DtTm|       Response DtTm|       On Scene DtTm|      Transport DtTm|       Hospital DtTm|Call Final Disposition|      Available DtTm|             Address|City|Zipcode of Incident|Battalion|Station Area| Box|Original Priority|Priority|Final Priority|ALS Unit|Call Type Group|Number of Alarms|   Unit Type|Unit sequence in call dispatch|Fire Prevention District|Supervisor District|Neighborhooods - Analysis Boundaries|            Location|        RowID|
+-----------+-------+---------------+--------------------+----------+----------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------------------+--------------------+--------------------+----+-------------------+---------+------------+----+-----------------+--------+--------------+--------+---------------+----------------+------------+------------------------------+------------------------+-------------------+------------------------------------+--------------------+-------------+
|  001030101|    E18|       00306091|    Medical Incident|04/12/2000|04/12/2000|04/12/2000 09:00:...|04/12/2000 09:01:...|04/12/2000 09:02:...|                    |                    |                    |                    |                 Other|                    |2000 Block of 37T...|  SF|              94116|      B08|          18| 757|                3|       3|             3|   false|               |               1|      ENGINE|                             1|                       8|                  4|                     Sunset/Parkside|(37.7487247711275...|001030101-E18|
|  001030107|    E01|       00030615|              Alarms|04/12/2000|04/12/2000|04/12/2000 09:13:...|04/12/2000 09:13:...|04/12/2000 09:14:...|04/12/2000 09:15:...|04/12/2000 09:20:...|                    |                    |                 Other|04/12/2000 09:24:...|100 Block of JONE...|  SF|              94102|      B03|          01|1456|                3|       3|             3|   false|               |               1|      ENGINE|                             3|                       3|                  6|                          Tenderloin|(37.7825474000421...|001030107-E01|

1) Load the data from file “fire.csv” into dataframe “input_df”
An.
val firedept_df = sqlContext.read.format("com.databricks.spark.csv").option("header", "true").option("inferSchema", "true").option("delimiter", ",").load("sb_sparkSQL_ds/fire_snapshot.csv")

|Call Number|Unit ID|Incident Number|           Call Type| Call Date|Watch Date|       Received DtTm|          Entry DtTm|       Dispatch DtTm|       Response DtTm|       On Scene DtTm|      Transport DtTm|       Hospital DtTm|Call Final Disposition|      Available DtTm|             Address|City|Zipcode of Incident|Battalion|Station Area| Box|Original Priority|Priority|Final Priority|ALS Unit|Call Type Group|Number of Alarms|   Unit Type|Unit sequence in call dispatch|Fire Prevention District|Supervisor District|Neighborhooods - Analysis Boundaries|            Location|        RowID|
+-----------+-------+---------------+--------------------+----------+----------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------------------+--------------------+--------------------+----+-------------------+---------+------------+----+-----------------+--------+--------------+--------+---------------+----------------+------------+------------------------------+------------------------+-------------------+------------------------------------+--------------------+-------------+
|  001030101|    E18|       00306091|    Medical Incident|04/12/2000|04/12/2000|04/12/2000 09:00:...|04/12/2000 09:01:...|04/12/2000 09:02:...|                    |                    |                    |                    |                 Other|                    |2000 Block of 37T...|  SF|              94116|      B08|          18| 757|                3|       3|             3|   false|               |               1|      ENGINE|                             1|                       8|                  4|                     Sunset/Parkside|(37.7487247711275...|001030101-E18|
|  001030107|    E01|       00030615|              Alarms|04/12/2000|04/12/2000|04/12/2000 09:13:...|04/12/2000 09:13:...|04/12/2000 09:14:...|04/12/2000 09:15:...|04/12/2000 09:20:...|                    |                    |                 Other|04/12/2000 09:24:...|100 Block of JONE...|  SF|              94102|      B03|          01|1456|                3|       3|             3|   false|               |               1|      ENGINE|                             3|                       3|                  6|                          Tenderloin|(37.7825474000421...|001030107-E01|

2) Print the schema of the data
An. firedept_df.printSchema
root
 |-- Call Number: string (nullable = true)
 |-- Unit ID: string (nullable = true)
 |-- Incident Number: string (nullable = true)
 |-- Call Type: string (nullable = true)
 |-- Call Date: string (nullable = true)
 |-- Watch Date: string (nullable = true)
 |-- Received DtTm: string (nullable = true)
 |-- Entry DtTm: string (nullable = true)
 |-- Dispatch DtTm: string (nullable = true)
 |-- Response DtTm: string (nullable = true)
 |-- On Scene DtTm: string (nullable = true)
 |-- Transport DtTm: string (nullable = true)
 |-- Hospital DtTm: string (nullable = true)
 |-- Call Final Disposition: string (nullable = true)
 |-- Available DtTm: string (nullable = true)
 |-- Address: string (nullable = true)
 |-- City: string (nullable = true)
 |-- Zipcode of Incident: integer (nullable = true)
 |-- Battalion: string (nullable = true)
 |-- Station Area: string (nullable = true)
 |-- Box: integer (nullable = true)
 |-- Original Priority: string (nullable = true)
 |-- Priority: string (nullable = true)
 |-- Final Priority: string (nullable = true)
 |-- ALS Unit: string (nullable = true)
 |-- Call Type Group: string (nullable = true)
 |-- Number of Alarms: integer (nullable = true)
 |-- Unit Type: string (nullable = true)
 |-- Unit sequence in call dispatch: integer (nullable = true)
 |-- Fire Prevention District: integer (nullable = true)
 |-- Supervisor District: integer (nullable = true)
 |-- Neighborhooods - Analysis Boundaries: string (nullable = true)
 |-- Location: string (nullable = true)
 |-- RowID: string (nullable = true)

3) In the Data Frame
	a) Retrieve the first 5 records
	An. firedept_df.show(5)
	only showing top 5 rows
	
	b) Print just the column names
	An.firedept_df.dtypes
		res9: Array[(String, String)] = Array((Call Number,StringType), (Unit ID,StringType), (Incident Number,StringType), (Call Type,St
		ringType), (Call Date,StringType), (Watch Date,StringType), (Received DtTm,StringType), (Entry DtTm,StringType), (Dispatch DtTm,S
		tringType), (Response DtTm,StringType), (On Scene DtTm,StringType), (Transport DtTm,StringType), (Hospital DtTm,StringType), (Cal
		l Final Disposition,StringType), (Available DtTm,StringType), (Address,StringType), (City,StringType), (Zipcode of Incident,Integ
		erType), (Battalion,StringType), (Station Area,StringType), (Box,IntegerType), (Original Priority,StringType), (Priority,StringTy
		pe), (Final Priority,StringType), (ALS Unit,StringType), (Call Type Group,StringType), (Number of Alarms,IntegerType), (Unit Type
		,StringType), (Unit seq...
		
	c) Count the total number of rows
	An. firedept_df.count

4) How many different types of calls were made to the Fire Department?
firedept_df.registerTempTable("fire_table")

sqlContext.sql("select count(distinct(`Call Type`)) from fire_table").show
sqlContext.sql("select distinct(`Call Type`) from fire_table").show

5) How many incidents of each type were there?
sqlContext.sql("select `Call Type`,count(`Incident Number`) from fire_table group by `Call Type`").show

6) Count the number of partitions the data frame comprises of. If the number is greater than 6, reduce the number of partitions
 to 6.
 An firedept_df.rdd.partitions.length
 
8) Use SQL queries to answer the following:
	a) Print the schema of “fire” table
	b) Count the number of rows in data
		sqlContext.sql("select count(1) from fire_table").show
	c) Show all the distinct city names in the table
		sqlContext.sql("select distinct(City) from fire_table").show
	d) Arrange the city names returned in b) in lexicographical order
	e) List all the distinct ‘Priorities’ in table 
		sqlContext.sql("select distinct(Priority) from fire_table").show
	f) Which neighborhood generated the most number of calls
		sqlContext.sql("select `Neighborhooods - Analysis Boundaries`,count(`Call Date`) as call_count from fire_table group by `Neighborhooods - Analysis Boundaries` order by call_count desc").show


----------------------------------------------------------------------------
METHOD-2

spark-shell --packages com.databricks:spark-csv_2.10:1.5.0

import org.apache.spark.sql.types.{StringType, StructField, StructType, StringType}

val fire_schema = StructType(Array(StructField("Call_Number",StringType,false),
StructField("Unit_ID",StringType,false),
StructField("Incident_Number",StringType,false),
StructField("Call_Type",StringType,false),
StructField("Call_Date",StringType,false),
StructField("Watch_Date",StringType,false),
StructField("Received_DtTm",StringType,false),
StructField("Entry_DtTm",StringType,false),
StructField("Dispatch_DtTm",StringType,false),
StructField("Response_DtTm",StringType,false),
StructField("On_Scene_DtTm",StringType,false),
StructField("Transport_DtTm",StringType,false),
StructField("Hospital_DtTm",StringType,false),
StructField("Call_Final_Disposition",StringType,false),
StructField("Available_DtTm",StringType,false),
StructField("Address",StringType,false),
StructField("City",StringType,false),
StructField("Zipcode_of_Incident",StringType,false),
StructField("Battalion",StringType,false),
StructField("Station_Area",StringType,false),
StructField("Box",StringType,false),
StructField("Original_Priority",StringType,false),
StructField("Priority",StringType,false),
StructField("Final_Priority",StringType,false),
StructField("ALS_Unit",StringType,false),
StructField("Call_Type_Group",StringType,false),
StructField("Number_of_Alarms",StringType,false),
StructField("Unit_Type",StringType,false),
StructField("Unit_sequence_call_dispatch",StringType,false),
StructField("Fire_Prevention_District",StringType,false),
StructField("Supervisor_District",StringType,false),
StructField("Neighborhooods_Analysis_Boundaries",StringType,false),
StructField("Location",StringType,false),
StructField("RowID",StringType,false)))

val fire_df = sqlContext.read.format("com.databricks.spark.csv").option("header", "false").option("inferSchema", "true").option("delimiter", ",").schema(fire_schema).load("sb_sparkSQL_ds/fire_snapshot.csv")



		